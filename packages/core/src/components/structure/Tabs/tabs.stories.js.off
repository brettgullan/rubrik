import React, { createRef } from 'react'

import { useTabs } from '@zendeskgarden/container-tabs'
import { withKnobs, optionsKnob as options } from '@storybook/addon-knobs'

// ----------------------------------------------------------------------------

import { Box, Flex } from 'rebass'

// ----------------------------------------------------------------------------

const tabs = ['Tab 1', 'Tab 2', 'Tab 3']
const tabRefs = tabs.map(() => createRef(null))

// ----------------------------------------------------------------------------

const Tabs = () => {
  const {
    selectedItem,
    getTabProps,
    getTabListProps,
    getTabPanelProps,
  } = useTabs({ idPrefix: 'tabs' })

  const tabComponents = []
  const tabPanels = []

  tabs.forEach((tab, index) => {
    tabComponents.push(
      <Box
        as="li"
        sx={{
          p: 2,
          borderBottom: `3px solid ${
            tab === selectedItem ? '#1f73b7' : 'transparent'
          }`,
        }}
        {...getTabProps({
          item: tab,
          index,
          ref: tabRefs[index],
          focusRef: tabRefs[index],
          key: tab,
        })}
      >
        {tab}
      </Box>
    )

    tabPanels.push(
      <Box
        sx={{
          p: 4,
        }}
        {...getTabPanelProps({
          index,
          item: tab,
          key: tab,
        })}
      >
        {tab} Content
      </Box>
    )
  })

  return (
    <>
      <Flex
        as="ul"
        sx={{
          p: 3,
          m: 0,
          listStyle: 'none',
        }}
        {...getTabListProps()}
      >
        {tabComponents}
      </Flex>
      {tabPanels}
    </>
  )
}

// ----------------------------------------------------------------------------

export default {
  title: 'Design System|Elements/Structure/Tabs',
  decorators: [withKnobs],
}

// ----------------------------------------------------------------------------

export const Primary = () => {
  return <Tabs />
}
